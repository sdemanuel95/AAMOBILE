package com.tofitsolutions.armasdurasargentinas.com.tofitsolutions.armadurasargentinas.DAO;

import android.os.AsyncTask;

import com.tofitsolutions.armasdurasargentinas.Conexion;
import com.tofitsolutions.armasdurasargentinas.Maquina;
import com.tofitsolutions.armasdurasargentinas.MateriaPrima;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

public class MaquinaDAOImpl extends AsyncTask<Void,Void, Void> implements MaquinaDAO {


    ArrayList<Maquina> maquinas = new ArrayList<>();
    String maquina;

    public MaquinaDAOImpl(String maquina) {
        this.maquina = maquina;
    }


    public ArrayList<Maquina> getMaquinas() {
        return maquinas;
    }


    @Override
    public ArrayList<Maquina> traerMaquinas() {
        return null;
    }


    @Override
    protected Void doInBackground(Void... voids) {
        this.maquinas = traerEstribadoras();
        return null;
    }

    @Override
    protected void onPostExecute(Void aVoid) {
        super.onPostExecute(aVoid);
    }

    @Override
    public ArrayList<Maquina> traerEstribadoras() {
        Conexion conexion = new Conexion();

        ArrayList<Maquina> estribadoras = new ArrayList<>();
        try {
            Class.forName("com.mysql.jdbc.Driver");

            Connection con = conexion.crearConexion();


            Statement stmt = con.createStatement();
            final ResultSet rs = stmt.executeQuery("SELECT * FROM maquina where clasificacion = 'estribadora'");
            while (rs.next()) {
                long id = rs.getInt("ID");
                String clasificacion = rs.getString("clasificacion");
                String marca = rs.getString("marca");
                String modelo = rs.getString("modelo");
                String tipo_mp = rs.getString("tipo_mp");
                String diametro_minimo = rs.getString("diametro_minimo");
                String diametro_maximo = rs.getString("diametro_maximo");
                String merma = rs.getString("merma");
                estribadoras.add(new Maquina(id, clasificacion, marca, modelo, tipo_mp, diametro_minimo, diametro_maximo, merma));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
        return estribadoras;
    }

    @Override
    public ArrayList<Maquina> traerDobladoras() {
        Conexion conexion = new Conexion();

        ArrayList<Maquina> estribadoras = new ArrayList<>();
        try {
            Class.forName("com.mysql.jdbc.Driver");

            Connection con = conexion.crearConexion();


            Statement stmt = con.createStatement();
            final ResultSet rs = stmt.executeQuery("SELECT * FROM maquina where clasificacion = 'estribadora'");
            while (rs.next()) {
                long id = rs.getInt("ID");
                String clasificacion = rs.getString("clasificacion");
                String marca = rs.getString("marca");
                String modelo = rs.getString("modelo");
                String tipo_mp = rs.getString("tipo_mp");
                String diametro_minimo = rs.getString("diametro_minimo");
                String diametro_maximo = rs.getString("diametro_maximo");
                String merma = rs.getString("merma");
                estribadoras.add(new Maquina(id, clasificacion, marca, modelo, tipo_mp, diametro_minimo, diametro_maximo, merma));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
        return estribadoras;
    }

    @Override
    public ArrayList<Maquina> traerCortadoras() {
        Conexion conexion = new Conexion();

        ArrayList<Maquina> estribadoras = new ArrayList<>();
        try {
            Class.forName("com.mysql.jdbc.Driver");

            Connection con = conexion.crearConexion();


            Statement stmt = con.createStatement();
            final ResultSet rs = stmt.executeQuery("SELECT * FROM maquina where clasificacion = 'estribadora'");
            while (rs.next()) {
                long id = rs.getInt("ID");
                String clasificacion = rs.getString("clasificacion");
                String marca = rs.getString("marca");
                String modelo = rs.getString("modelo");
                String tipo_mp = rs.getString("tipo_mp");
                String diametro_minimo = rs.getString("diametro_minimo");
                String diametro_maximo = rs.getString("diametro_maximo");
                String merma = rs.getString("merma");
                estribadoras.add(new Maquina(id, clasificacion, marca, modelo, tipo_mp, diametro_minimo, diametro_maximo, merma));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
        return estribadoras;


    }

}
